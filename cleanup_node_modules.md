# Node Modules Cleanup Script for Windows

A safe and fault-tolerant Python script that recursively scans your Windows drive for `node_modules` directories and removes them to free up disk space.

## Features

- ğŸ” **Recursive Scanning** - Scans entire drive including all subdirectories
- ğŸ“Š **Detailed Logging** - Shows full path and size of each `node_modules` directory found
- âœ… **User Confirmation** - Requires explicit confirmation before any deletion
- ğŸ›¡ï¸ **Safe Operation** - Only deletes `node_modules` folders, nothing else
- ğŸš« **Smart Skipping** - Automatically skips system-protected and permission-denied folders
- ğŸ“ˆ **Comprehensive Summary** - Displays total folders found, deleted, and disk space freed
- âš¡ **Standard Library Only** - No external dependencies required

## Requirements

- Windows Operating System
- Python 3.6 or higher
- Administrator privileges (recommended for full drive access)

## Usage

1. **Run the script:**
   ```powershell
   python cleanup_node_modules.py
   ```

2. **Review the findings:**
   - The script will scan D:\ drive (configurable)
   - Display all found `node_modules` directories with their sizes
   - Show total space that will be freed

3. **Confirm deletion:**
   - Type `yes` or `y` to proceed with deletion
   - Type `no` or `n` to cancel the operation

4. **View the summary:**
   - Total folders found and deleted
   - Total disk space freed
   - Any failed deletions with reasons

## Configuration

To scan a different drive, modify the `root_path` variable in the `main()` function:

```python
# Define the root path
root_path = "D:\\"  # Change to "C:\\", "E:\\", etc.
```

## Safety Features

### Protected Directories
The script automatically skips:
- Windows system directories (Windows, Program Files, etc.)
- Hidden and system directories
- Recycle Bin and Recovery folders
- Any directory it doesn't have permission to access

### Error Handling
- **Permission Denied** - Logs the directory and continues scanning
- **System Protected** - Automatically skips without attempting access
- **Locked Files** - Reports failure and continues with remaining deletions
- **Keyboard Interrupt** - Gracefully handles Ctrl+C cancellation

## Example Output

```
======================================================================
Node Modules Cleanup Script for Windows
======================================================================

ğŸ” Scanning D:\ for node_modules directories...
This may take a while depending on the size of your drive.

Found: D:\Projects\my-app\node_modules
Found: D:\Development\react-app\node_modules

======================================================================
ğŸ“Š SCAN RESULTS
======================================================================

Found 2 node_modules directories:

1. D:\Projects\my-app\node_modules
   Size: 238.74 MB
2. D:\Development\react-app\node_modules
   Size: 289.09 MB

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total space occupied: 527.83 MB
======================================================================

âš ï¸  WARNING: This will permanently delete the above directories!

Do you want to proceed with deletion? (yes/no): yes

ğŸ—‘ï¸  Starting deletion process...

Deleting: D:\Projects\my-app\node_modules (238.74 MB)
âœ“ Successfully deleted
Deleting: D:\Development\react-app\node_modules (289.09 MB)
âœ“ Successfully deleted

======================================================================
ğŸ“ˆ SUMMARY
======================================================================

Total node_modules folders found: 2
Successfully deleted: 2
Failed to delete: 0
Total disk space freed: 527.83 MB

âœ“ Cleanup process completed!
======================================================================
```

## How It Works

1. **Scanning Phase**
   - Uses `os.walk()` to recursively traverse the directory tree
   - Identifies directories named `node_modules`
   - Calculates size of each directory
   - Skips protected and inaccessible directories

2. **Reporting Phase**
   - Displays all found directories with formatted sizes
   - Shows total space that will be freed
   - Waits for user confirmation

3. **Deletion Phase**
   - Uses `shutil.rmtree()` to remove directories
   - Handles errors gracefully (permissions, locked files)
   - Tracks successful and failed deletions

4. **Summary Phase**
   - Reports total statistics
   - Lists any failed deletions with reasons
   - Shows final disk space freed

## Common Issues

### Path Too Long Error
Some `node_modules` directories may fail to delete due to Windows' 260-character path limit. Failed deletions are logged in the summary.

**Solution:** Manually delete using tools like `robocopy` or enable long path support in Windows.

### Permission Denied
Some directories may be protected or in use by other processes.

**Solution:** 
- Run PowerShell as Administrator
- Close IDEs and Node.js processes
- Manually delete remaining folders

### Drive Not Found
If the specified drive doesn't exist, the script will exit with an error message.

**Solution:** Verify the drive letter and ensure it's accessible.

## Technical Details

### Functions

- `get_directory_size(path)` - Calculates total size of a directory in bytes
- `format_size(bytes_size)` - Converts bytes to human-readable format (KB, MB, GB)
- `find_node_modules(root_path)` - Recursively searches for node_modules directories
- `is_protected_directory(path)` - Checks if a directory should be skipped
- `delete_node_modules(directories)` - Deletes the specified directories
- `main()` - Orchestrates the entire cleanup process

### Standard Library Modules Used

- `os` - File system operations and path handling
- `shutil` - High-level file operations (directory deletion)
- `sys` - System-specific parameters and functions
- `pathlib` - Object-oriented filesystem paths

## Best Practices

1. **Review Before Deletion** - Always check the list of directories before confirming
2. **Regular Cleanup** - Run periodically to maintain disk space
3. **Backup Important Projects** - Ensure you can reinstall dependencies with `npm install`
4. **Check package.json** - Verify all projects have `package.json` files for easy restoration

## Restoring node_modules

After cleanup, you can restore `node_modules` for any project by navigating to the project directory and running:

```bash
npm install
```

or

```bash
yarn install
```

## License

This script is provided as-is for personal and educational use.

## Author

Created for Windows environments to help developers manage disk space consumed by Node.js project dependencies.

---

**âš ï¸ Warning:** This script permanently deletes directories. Always ensure you can restore dependencies before running the cleanup.
